/* ========== 플러팅 능력 테스트 ========== */

window.TEST_CONFIG = {
  id: 'flirting',
  title: '플러팅 능력 테스트',
  subtitle: '나의 플러팅 등급은?',
  emoji: '\uD83D\uDE18',
  participants: 4800,
  duration: '2분',
  loadingMessages: [
    '플러팅 실력을 분석하는 중...',
    '매력도를 측정하고 있어요...',
    '등급이 나왔어요!',
  ],
};

window.QUESTIONS = [
  {
    question: '호감 있는 사람 앞에서 나는?',
    options: [
      { text: '평소보다 말이 많아지고 텐션 올라감', scores: { flirt: 5 } },
      { text: '오히려 조용해지고 어색해짐', scores: { flirt: 2 } },
      { text: '장난을 많이 치면서 관심 끌기', scores: { flirt: 4 } },
      { text: '달라지는 거 없음... 그냥 평소랑 똑같아', scores: { flirt: 1 } },
    ],
  },
  {
    question: '카톡으로 호감을 표현하는 나만의 방식은?',
    options: [
      { text: '귀여운 이모티콘 폭격 + 리액션 오버', scores: { flirt: 4 } },
      { text: '답장을 세상에서 제일 빠르게 보내기', scores: { flirt: 3 } },
      { text: '"뭐해?" "밥 먹었어?" 질문으로 대화 유지', scores: { flirt: 5 } },
      { text: '재밌는 밈이나 짤 공유하면서 자연스럽게', scores: { flirt: 4 } },
    ],
  },
  {
    question: '호감 있는 사람과 단둘이 있으면?',
    options: [
      { text: '눈을 자주 마주치면서 미소 짓기', scores: { flirt: 6 } },
      { text: '은근히 가까이 앉거나 살짝 터치', scores: { flirt: 5 } },
      { text: '고민 상담 분위기로 끌고 가서 친해지기', scores: { flirt: 4 } },
      { text: '긴장돼서 핸드폰만 만지작거림', scores: { flirt: 1 } },
    ],
  },
  {
    question: '상대가 호감 신호를 보내면?',
    options: [
      { text: '바로 알아챔! 센서 만렙이야', scores: { flirt: 6 } },
      { text: '좀 지나서 "어... 혹시 나 좋아하나?" 뒤늦게 깨달음', scores: { flirt: 3 } },
      { text: '착각일까 봐 무시하고 넘어감', scores: { flirt: 2 } },
      { text: '호감 신호가 뭔데...? 그런 거 받아본 적 없는데', scores: { flirt: 1 } },
    ],
  },
  {
    question: '마음에 드는 사람의 SNS에\n새 게시물이 올라오면?',
    options: [
      { text: '좋아요 + 센스 있는 댓글 바로 달기', scores: { flirt: 6 } },
      { text: '좋아요만 살짝 누르기 (DM은 부담)', scores: { flirt: 3 } },
      { text: '스토리 답장으로 자연스럽게 대화 시작', scores: { flirt: 5 } },
      { text: '몰래 보기만 함... 흔적 남기기 무서워', scores: { flirt: 1 } },
    ],
  },
  {
    question: '호감 있는 사람에게\n자연스럽게 연락처를 받는 방법은?',
    options: [
      { text: '"우리 카톡 해요!" 직접적으로 말하기', scores: { flirt: 6 } },
      { text: '"단톡방 만들자~" 하면서 슬쩍 번호 따기', scores: { flirt: 5 } },
      { text: '공통 관심사 핑계로 "이거 보내줄게!" 하면서', scores: { flirt: 4 } },
      { text: '아직 연락처를 직접 물어본 적이 없어...', scores: { flirt: 1 } },
    ],
  },
  {
    question: '칭찬을 할 때 나의 스타일은?',
    options: [
      { text: '"오늘 진짜 예쁘다/멋있다" 직접적으로', scores: { flirt: 6 } },
      { text: '"머리 잘랐어? 잘 어울린다~" 변화를 짚어서', scores: { flirt: 5 } },
      { text: '"ㅋㅋ 뭐야 귀엽네" 장난스럽게', scores: { flirt: 4 } },
      { text: '칭찬을 잘 안 함... 속으로만 생각해', scores: { flirt: 1 } },
    ],
  },
  {
    question: '호감 있는 사람과 약속을 잡을 때?',
    options: [
      { text: '"이번 주 토요일 뭐 해? 나랑 여기 갈래?" 구체적으로', scores: { flirt: 6 } },
      { text: '"우리 언제 밥 한번 먹자~" 가볍게 던지기', scores: { flirt: 4 } },
      { text: '단체 모임 만들어서 자연스럽게 같이 오게 유도', scores: { flirt: 3 } },
      { text: '약속 잡고 싶은데 거절당할까 봐 못 물어봄', scores: { flirt: 1 } },
    ],
  },
  {
    question: '눈 마주침에 대한 나의 자세는?',
    options: [
      { text: '2초 이상 쳐다보면서 살짝 미소 날리기', scores: { flirt: 6 } },
      { text: '눈 마주치면 먼저 웃어주기', scores: { flirt: 5 } },
      { text: '마주치면 "뭐 봐~" 하면서 장난치기', scores: { flirt: 4 } },
      { text: '눈 마주치면 바로 돌려! 심장 터져', scores: { flirt: 2 } },
    ],
  },
  {
    question: '상대방이 "나 요즘 외로워~" 하면?',
    options: [
      { text: '"그럼 내가 옆에 있어줄까?" (직구)', scores: { flirt: 6 } },
      { text: '"ㅋㅋ 나도~ 우리 외로운 사람끼리 만날까?"', scores: { flirt: 5 } },
      { text: '"에이~ 네가 왜 외로워, 인기 많잖아"', scores: { flirt: 4 } },
      { text: '"ㅇㅇ 나도..." (공감은 하는데 플러팅으로 못 이어감)', scores: { flirt: 2 } },
    ],
  },
  {
    question: '자연스러운 바디랭귀지, 나는?',
    options: [
      { text: '어깨 터치, 팔 가볍게 치기 등 자연스럽게 접촉', scores: { flirt: 6 } },
      { text: '의자를 가까이 당기거나 상체 기울이기', scores: { flirt: 5 } },
      { text: '머리카락 만지기, 옷매무새 정리 등 은근 어필', scores: { flirt: 4 } },
      { text: '바디랭귀지? 나는 몸이 돌이야... 경직 그 자체', scores: { flirt: 1 } },
    ],
  },
  {
    question: '마지막 질문! 플러팅에 대한\n나의 솔직한 자기 평가는?',
    options: [
      { text: '나 좀 잘하는 편인 것 같아 ㅎㅎ', scores: { flirt: 6 } },
      { text: '상황에 따라 다르지만 할 때는 해', scores: { flirt: 4 } },
      { text: '하고 싶은데 잘 안 돼... 연습 필요해', scores: { flirt: 3 } },
      { text: '플러팅이 뭔지도 잘 모르겠어', scores: { flirt: 1 } },
    ],
  },
];

window.RESULTS = {
  SS: {
    name: 'SS급 플러팅 장인',
    emoji: '\uD83D\uDE0E',
    description: '타고난 매력 + 완벽한 스킬 = 플러팅계의 전설',
    detail:
      '당신은 플러팅의 정석을 몸으로 체득한 천상계 플러터입니다. 상대의 미세한 감정 변화를 캐치하는 센서가 있고, 적절한 타이밍에 적절한 말과 행동을 구사합니다. 눈 마주침부터 바디랭귀지, 대화 스킬까지 모든 영역에서 만점에 가까운 능력치를 보유하고 있어요.\n\n' +
      '나의 플러팅 스타일 키워드: #본능적매력 #완벽한타이밍 #상대맞춤형\n\n' +
      '이렇게 하면 한 단계 업: 사실 당신은 더 올라갈 단계가 없어요. 다만, 너무 잘하는 것도 문제가 될 수 있답니다. 가끔은 의도적으로 서투른 모습을 보여주세요. "이 사람도 인간이구나" 하는 순간에 상대방은 더 깊이 빠지게 됩니다. 진심을 섞어야 플러팅도 완성이에요.',
    traits: ['천상계플러터', '매력만렙', '연애고수'],
    strengths: [
      '상대의 감정을 정확히 읽고 맞춤형 반응을 보여줌',
      '적절한 거리감 조절로 밀당의 고수',
      '말, 표정, 행동 모든 면에서 매력이 넘침',
    ],
    weaknesses: [
      '너무 잘해서 진심이 의심받을 수 있음',
      '무의식적 플러팅으로 오해를 살 때가 있음',
      '플러팅 실력에 비해 진지한 감정 표현이 서툴 수 있음',
    ],
    good: 'D급 플러팅 문외한 (갭 차이에 심쿵)',
    bad: 'SS급 플러팅 장인 (주도권 싸움 발생)',
  },
  S: {
    name: 'S급 프로 플러터',
    emoji: '\uD83C\uDF1F',
    description: '의식하든 안 하든 은근히 잘하는 타입',
    detail:
      '당신은 자연스러움이 무기인 프로 플러터입니다. 억지스럽지 않고, 부담스럽지 않게 호감을 전달하는 능력이 탁월해요. 특히 대화 중에 상대를 특별하게 만들어주는 센스가 빛납니다. 당신과 대화하면 모두가 "나한테 관심 있나?" 하고 착각할 정도.\n\n' +
      '나의 플러팅 스타일 키워드: #자연스러움끝판왕 #분위기메이커 #은근한매력\n\n' +
      '이렇게 하면 한 단계 업: 당신에게 부족한 건 "결정적 한 방"입니다. 분위기를 잘 만들지만 마지막 한 수에서 주저하는 경향이 있어요. 좋은 분위기가 만들어졌을 때, 용기 있게 한 발 더 다가가 보세요. "오늘 진짜 예뻐" 같은 직구 한 마디가 판을 뒤집습니다.',
    traits: ['자연스러운매력', '센스만점', '분위기장인'],
    strengths: [
      '자연스럽게 호감을 전달해서 부담이 없음',
      '분위기를 잘 읽고 적절히 대처하는 능력',
      '대화할 때 상대를 특별하게 느끼게 해줌',
    ],
    weaknesses: [
      '결정적인 순간에 한 발 더 나아가지 못할 때가 있음',
      '모두에게 잘해서 "나만 특별한 건가?" 하는 의문을 줄 수 있음',
      '플러팅과 관심의 경계가 모호할 때가 있음',
    ],
    good: 'C급 초보 플러터 (당신의 리드에 설렘 폭발)',
    bad: 'SS급 플러팅 장인 (서로 밀당만 하다가 지침)',
  },
  A: {
    name: 'A급 실전형 플러터',
    emoji: '\uD83D\uDCAA',
    description: '필요할 때 확실하게 꺼내 쓰는 타입',
    detail:
      '당신은 평소에는 조용하지만, 마음에 드는 사람이 나타나면 숨겨왔던 매력을 폭발시키는 실전형 플러터입니다. 플러팅 스킬이 꾸준히 있는 타입은 아니지만, 진짜 하고 싶을 때의 집중력과 성공률은 상당합니다. ON/OFF가 확실한 게 매력 포인트!\n\n' +
      '나의 플러팅 스타일 키워드: #온오프확실 #집중형어택 #숨겨진매력\n\n' +
      '이렇게 하면 한 단계 업: 평소에도 가벼운 플러팅 연습을 해보세요. 편의점 직원에게 웃으며 인사하기, 친구에게 외모 칭찬하기 같은 소소한 것부터요. 플러팅 근육도 매일 쓰면 강해집니다. 관심 있는 사람한테만 특별히 잘하려 하면 오히려 경직될 수 있어요.',
    traits: ['실전형매력', '온오프확실', '집중어택'],
    strengths: [
      '진짜 좋아하는 사람에게 집중적으로 매력 어필',
      '진심이 담겨 있어서 상대가 진정성을 느낌',
      '가끔 보이는 의외의 매력으로 반전 어필',
    ],
    weaknesses: [
      '평소 무뚝뚝해서 호감인지 아닌지 구분이 안 됨',
      '플러팅 모드가 ON일 때와 OFF일 때 갭이 큼',
      '연습 부족으로 실전에서 어색할 때가 있음',
    ],
    good: 'B급 평범한 사람 (서로 편하게 발전 가능)',
    bad: 'S급 프로 플러터 (속도 차이로 엇갈림)',
  },
  B: {
    name: 'B급 평범한 사람',
    emoji: '\uD83D\uDE0A',
    description: '못 하는 건 아닌데 특출나지도 않은 딱 평범',
    detail:
      '당신은 평범한 플러팅 능력의 소유자입니다. 관심 있는 사람에게 기본적인 호감 표현은 할 수 있지만, "이 사람 나 좋아하나?" 하고 상대를 헷갈리게 만들 정도의 스킬은 아직 부족해요. 하지만 그 솔직하고 꾸밈없는 모습이 오히려 매력인 경우도 많답니다!\n\n' +
      '나의 플러팅 스타일 키워드: #솔직담백 #꾸밈없는매력 #기본기장착\n\n' +
      '이렇게 하면 한 단계 업: 상대의 변화를 관찰하고 말로 표현해보세요. "오늘 기분 좋아 보인다", "그 옷 새로 샀어? 잘 어울린다" 같은 디테일한 관심이 플러팅의 시작입니다. 대단한 기술이 필요한 게 아니에요. 관심을 "말"로 표현하는 연습만 해도 확 달라집니다.',
    traits: ['솔직담백', '꾸밈없음', '성장가능성'],
    strengths: [
      '진심이 느껴져서 신뢰를 줄 수 있음',
      '부담스럽지 않아서 상대가 편안함',
      '기본적인 대화와 매너는 갖추고 있음',
    ],
    weaknesses: [
      '호감 표현이 약해서 "그냥 친구인 줄" 오해받기 쉬움',
      '특별한 인상을 남기기 어려울 수 있음',
      '적극성이 부족해서 기회를 놓치는 경우가 많음',
    ],
    good: 'A급 실전형 플러터 (부족한 부분을 채워줌)',
    bad: 'F급 연애 고자 (둘 다 진전이 없어서 정체)',
  },
  C: {
    name: 'C급 초보 플러터',
    emoji: '\uD83D\uDE05',
    description: '마음은 있는데 표현이 서투른 타입',
    detail:
      '당신은 마음속에 호감이 가득한데 그걸 밖으로 꺼내는 방법을 모르는 초보 플러터입니다. 좋아하는 사람 앞에서 긴장하고, 준비한 말이 입 밖으로 안 나오고, 나중에 혼자 "아까 이렇게 말했어야 하는데..." 하며 후회하는 일이 잦아요. 하지만 걱정 마세요, 플러팅은 연습이니까!\n\n' +
      '나의 플러팅 스타일 키워드: #마음만앞서 #사후후회형 #잠재력보유\n\n' +
      '이렇게 하면 한 단계 업: 거창한 것부터 하지 마세요. "밥 먹었어?" "오늘 하루 어땠어?" 같은 일상적 관심 표현부터 시작하세요. 대면이 어려우면 카톡으로 먼저 연습하는 것도 좋아요. 이모티콘 하나, 리액션 하나도 훌륭한 플러팅이 될 수 있답니다. 작은 것부터 천천히!',
    traits: ['순수초보', '마음은만렙', '서투른표현'],
    strengths: [
      '진심이 가득해서 알고 보면 매력적임',
      '서투른 모습 자체가 귀여워서 호감을 사는 경우 있음',
      '성장 가능성이 무궁무진함',
    ],
    weaknesses: [
      '좋아하는 사람 앞에서 제 실력 발휘를 못함',
      '타이밍을 자주 놓쳐서 기회가 사라짐',
      '관심 있는 티를 못 내서 상대가 모르고 지나감',
    ],
    good: 'S급 프로 플러터 (당신 대신 리드해줌)',
    bad: 'C급 초보 플러터 (서로 눈치만 보다 끝남)',
  },
  D: {
    name: 'D급 플러팅 문외한',
    emoji: '\uD83D\uDE36',
    description: '플러팅? 그게 먹는 건가요?',
    detail:
      '당신은 플러팅이라는 개념 자체가 아직 낯선 문외한입니다. 누가 호감 신호를 보내도 못 알아채고, 본인이 관심 있는 사람에게도 딱히 다르게 행동하지 못해요. "좋아하면 알아서 되는 거 아닌가?"라는 순수한 마인드의 소유자. 나쁜 건 아니지만 연애 시장에서는 꽤 불리한 위치...\n\n' +
      '나의 플러팅 스타일 키워드: #무의식무표현 #순수그자체 #연애인식제로\n\n' +
      '이렇게 하면 한 단계 업: 일단 "관심이 있다"는 걸 표현하는 것부터 시작하세요. 눈 마주쳤을 때 피하지 말고 1초만 더 바라보기, 상대의 이야기에 리액션 크게 하기, "나도 그거 좋아해!" 같은 공감 표현하기. 이 세 가지만 실천해도 인생이 달라집니다.',
    traits: ['플러팅문외한', '순수무구', '본능제로'],
    strengths: [
      '꾸밈이 없어서 오히려 신뢰감을 줄 수 있음',
      '서툰 모습이 순수해 보여서 모성/부성 본능 자극',
      '한 번 배우기 시작하면 발전 속도가 빠를 수 있음',
    ],
    weaknesses: [
      '상대의 호감 신호를 전혀 못 알아챔',
      '관심 표현 방법 자체를 모르는 상태',
      '연애 기회가 와도 인지하지 못하고 놓침',
    ],
    good: 'SS급 플러팅 장인 (일방적으로 이끌어줌)',
    bad: 'D급 플러팅 문외한 (서로 아무 일도 안 일어남)',
  },
  F: {
    name: 'F급 연애 고자',
    emoji: '\uD83E\uDEE0',
    description: '플러팅은커녕 대화부터 힘든 레벨...',
    detail:
      '당신은... 솔직히 플러팅 이전에 호감 있는 사람과 자연스러운 대화부터가 난관인 상태입니다. 좋아하는 사람이 말을 걸면 얼어붙고, 온몸이 경직되고, 머릿속이 새하얘지는 경험을 자주 하고 있죠. 하지만! F급이라고 해서 연애를 못 하는 건 절대 아니에요.\n\n' +
      '나의 플러팅 스타일 키워드: #극한긴장 #존재자체가플러팅 #바닥에서시작\n\n' +
      '이렇게 하면 한 단계 업: 먼저 자기 자신에게 자신감을 가지세요. 플러팅은 기술이 아니라 "나를 좋아해줬으면" 하는 마음의 표현이에요. 오늘부터 거울 보면서 "나 괜찮은 사람이다" 10번 말해보세요. 그리고 주변 사람에게 먼저 인사 한 번, 미소 한 번 연습하세요. 모든 위대한 플러터도 처음은 F급이었답니다.',
    traits: ['극한초보', '긴장마스터', '무한성장가능'],
    strengths: [
      '바닥이니까 올라갈 일만 남았음! 성장 폭이 가장 큼',
      '진심이 너무 강해서 언젠가 폭발하면 감동적임',
      '아무것도 안 해도 순수한 매력이 있음',
    ],
    weaknesses: [
      '좋아하는 사람 앞에서 정상적인 대화가 어려움',
      '기회가 와도 심장 폭발로 행동 불가 상태',
      '혼자 상상 연애만 하고 현실에서 진전이 없음',
    ],
    good: 'A급 실전형 플러터 (당신을 천천히 이끌어줌)',
    bad: 'F급 연애 고자 (둘 다 무한 정적... 영원한 평행선)',
  },
};

window.getResult = function (scores) {
  var total = scores.flirt || 0;

  var grade, result;
  if (total >= 72) {
    grade = 'SS';
  } else if (total >= 60) {
    grade = 'S';
  } else if (total >= 48) {
    grade = 'A';
  } else if (total >= 36) {
    grade = 'B';
  } else if (total >= 24) {
    grade = 'C';
  } else if (total >= 12) {
    grade = 'D';
  } else {
    grade = 'F';
  }

  result = window.RESULTS[grade];
  return {
    key: grade,
    name: result.name,
    emoji: result.emoji,
    description: result.description + '\n총점: ' + total + ' / 72점',
    detail: result.detail,
    traits: result.traits,
    strengths: result.strengths,
    weaknesses: result.weaknesses,
    good: result.good,
    bad: result.bad,
  };
};
